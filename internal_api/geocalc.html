

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ichnaea.geocalc &mdash; Ichnaea 2.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Ichnaea 2.0 documentation" href="../index.html"/>
        <link rel="up" title="Internal Code API" href="index.html"/>
        <link rel="next" title="ichnaea.geocode" href="geocode.html"/>
        <link rel="prev" title="ichnaea.exceptions" href="exceptions.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Ichnaea
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Using the Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Services API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../import_export.html">Data Import / Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algo/index.html">Algorithms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Internal Code API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#overview">Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#indices-and-tables">Indices and Tables</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="api/index.html"><code class="docutils literal"><span class="pre">ichnaea.api</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="async/index.html"><code class="docutils literal"><span class="pre">ichnaea.async</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html"><code class="docutils literal"><span class="pre">ichnaea.cache</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html"><code class="docutils literal"><span class="pre">ichnaea.config</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="constants.html"><code class="docutils literal"><span class="pre">ichnaea.constants</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="content/index.html"><code class="docutils literal"><span class="pre">ichnaea.content</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="data/index.html"><code class="docutils literal"><span class="pre">ichnaea.data</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="db.html"><code class="docutils literal"><span class="pre">ichnaea.db</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="exceptions.html"><code class="docutils literal"><span class="pre">ichnaea.exceptions</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><code class="docutils literal"><span class="pre">ichnaea.geocalc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="geocode.html"><code class="docutils literal"><span class="pre">ichnaea.geocode</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="geoip.html"><code class="docutils literal"><span class="pre">ichnaea.geoip</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="http.html"><code class="docutils literal"><span class="pre">ichnaea.http</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="log.html"><code class="docutils literal"><span class="pre">ichnaea.log</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="models/index.html"><code class="docutils literal"><span class="pre">ichnaea.models</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="queue.html"><code class="docutils literal"><span class="pre">ichnaea.queue</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="scripts/index.html"><code class="docutils literal"><span class="pre">ichnaea.scripts</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="util.html"><code class="docutils literal"><span class="pre">ichnaea.util</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="webapp/index.html"><code class="docutils literal"><span class="pre">ichnaea.webapp</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes/index.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Ichnaea</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Internal Code API</a> &raquo;</li>
      
    <li><code class="docutils literal"><span class="pre">ichnaea.geocalc</span></code></li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/internal_api/geocalc.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-ichnaea.geocalc">
<span id="ichnaea-geocalc"></span><h1><a class="reference internal" href="#module-ichnaea.geocalc" title="ichnaea.geocalc"><code class="xref py py-mod docutils literal"><span class="pre">ichnaea.geocalc</span></code></a><a class="headerlink" href="#module-ichnaea.geocalc" title="Permalink to this headline">¶</a></h1>
<p>Contains helper functions for various geo related calculations.</p>
<p>These are implemented in Cython / C using NumPy.</p>
<dl class="function">
<dt id="ichnaea.geocalc.bbox">
<code class="descclassname">ichnaea.geocalc.</code><code class="descname">bbox</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/mozilla/ichnaea/tree/master/ichnaea/geocalc.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ichnaea.geocalc.bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a bounding box around the passed in lat/lon position.</p>
</dd></dl>

<dl class="function">
<dt id="ichnaea.geocalc.circle_radius">
<code class="descclassname">ichnaea.geocalc.</code><code class="descname">circle_radius</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/mozilla/ichnaea/tree/master/ichnaea/geocalc.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ichnaea.geocalc.circle_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the maximum distance, in meters, from a (lat, lon) point
to any of the extreme points of a bounding box.</p>
</dd></dl>

<dl class="function">
<dt id="ichnaea.geocalc.destination">
<code class="descclassname">ichnaea.geocalc.</code><code class="descname">destination</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/mozilla/ichnaea/tree/master/ichnaea/geocalc.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ichnaea.geocalc.destination" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an initial point, a bearing and a distance in meters,
compute the destination point using the Vincenty formula.</p>
<dl class="docutils">
<dt>References:</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Vincenty's_formulae">https://en.wikipedia.org/wiki/Vincenty&#8217;s_formulae</a></li>
<li><a class="reference external" href="http://www.movable-type.co.uk/scripts/latlong-vincenty.html">http://www.movable-type.co.uk/scripts/latlong-vincenty.html</a></li>
<li><a class="reference external" href="https://github.com/geopy/geopy/blob/master/geopy/distance.py">https://github.com/geopy/geopy/blob/master/geopy/distance.py</a></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ichnaea.geocalc.haversine_distance">
<code class="descclassname">ichnaea.geocalc.</code><code class="descname">haversine_distance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/mozilla/ichnaea/tree/master/ichnaea/geocalc.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ichnaea.geocalc.haversine_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the distance between a pair of lat/longs in meters using
the Haversine calculation. The output distance is in meters.</p>
<dl class="docutils">
<dt>References:</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Haversine_formula">http://en.wikipedia.org/wiki/Haversine_formula</a></li>
<li><a class="reference external" href="http://www.movable-type.co.uk/scripts/latlong.html">http://www.movable-type.co.uk/scripts/latlong.html</a></li>
</ul>
</dd>
</dl>
<p>Accuracy: since the earth is not quite a sphere, there are small
errors in using spherical geometry; the earth is actually roughly
ellipsoidal (or more precisely, oblate spheroidal) with a radius
varying between about 6378km (equatorial) and 6357km (polar),
and local radius of curvature varying from 6336km (equatorial
meridian) to 6399km (polar). 6371 km is the generally accepted
value for the Earth&#8217;s mean radius. This means that errors from
assuming spherical geometry might be up to 0.55% crossing the
equator, though generally below 0.3%, depending on latitude and
direction of travel.</p>
</dd></dl>

<dl class="function">
<dt id="ichnaea.geocalc.latitude_add">
<code class="descclassname">ichnaea.geocalc.</code><code class="descname">latitude_add</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/mozilla/ichnaea/tree/master/ichnaea/geocalc.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ichnaea.geocalc.latitude_add" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a latitude in degrees which is shifted by
distance in meters.</p>
<p>The new latitude is bounded by our globally defined
<a class="reference internal" href="constants.html#ichnaea.constants.MIN_LAT" title="ichnaea.constants.MIN_LAT"><code class="xref py py-data docutils literal"><span class="pre">ichnaea.constants.MIN_LAT</span></code></a> and
<a class="reference internal" href="constants.html#ichnaea.constants.MAX_LAT" title="ichnaea.constants.MAX_LAT"><code class="xref py py-data docutils literal"><span class="pre">ichnaea.constants.MAX_LAT</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="ichnaea.geocalc.longitude_add">
<code class="descclassname">ichnaea.geocalc.</code><code class="descname">longitude_add</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/mozilla/ichnaea/tree/master/ichnaea/geocalc.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ichnaea.geocalc.longitude_add" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a longitude in degrees which is shifted by
distance in meters.</p>
<p>The new longitude is bounded by our globally defined
<a class="reference internal" href="constants.html#ichnaea.constants.MIN_LON" title="ichnaea.constants.MIN_LON"><code class="xref py py-data docutils literal"><span class="pre">ichnaea.constants.MIN_LON</span></code></a> and
<a class="reference internal" href="constants.html#ichnaea.constants.MAX_LON" title="ichnaea.constants.MAX_LON"><code class="xref py py-data docutils literal"><span class="pre">ichnaea.constants.MAX_LON</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="ichnaea.geocalc.max_distance">
<code class="descclassname">ichnaea.geocalc.</code><code class="descname">max_distance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/mozilla/ichnaea/tree/master/ichnaea/geocalc.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ichnaea.geocalc.max_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the maximum distance from the given lat/lon point to any of
the provided points in the points array.</p>
</dd></dl>

<dl class="function">
<dt id="ichnaea.geocalc.random_points">
<code class="descclassname">ichnaea.geocalc.</code><code class="descname">random_points</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/mozilla/ichnaea/tree/master/ichnaea/geocalc.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ichnaea.geocalc.random_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a row from the datamap table, return a list of
pseudo-randomized but stable points for the datamap grid.</p>
<p>The points look random, but their position only depends on the
passed in latitude and longitude. This ensures that on consecutive
calls with the same input data, the exact same output data is
returned, and the generated image tiles showing these points don&#8217;t
change. The randomness needs to be good enough to not show clear
visual patterns for adjacent grid cells, so a change in one of
the input arguments by 1 needs to result in a large change in
the pattern.</p>
</dd></dl>

<dl class="function">
<dt id="ichnaea.geocalc.vincenty_distance">
<code class="descclassname">ichnaea.geocalc.</code><code class="descname">vincenty_distance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/mozilla/ichnaea/tree/master/ichnaea/geocalc.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ichnaea.geocalc.vincenty_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the distance between a pair of lat/longs in meters using
the Vincenty formula.</p>
<dl class="docutils">
<dt>References:</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Vincenty's_formulae">https://en.wikipedia.org/wiki/Vincenty&#8217;s_formulae</a></li>
<li><a class="reference external" href="http://www.movable-type.co.uk/scripts/latlong-vincenty.html">http://www.movable-type.co.uk/scripts/latlong-vincenty.html</a></li>
<li><a class="reference external" href="https://github.com/geopy/geopy/blob/master/geopy/distance.py">https://github.com/geopy/geopy/blob/master/geopy/distance.py</a></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="geocode.html" class="btn btn-neutral float-right" title="ichnaea.geocode" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="exceptions.html" class="btn btn-neutral" title="ichnaea.exceptions" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2016, Mozilla.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>