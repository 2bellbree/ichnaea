

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Calculation &mdash; Ichnaea 1.4 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Ichnaea 1.4 documentation" href="index.html"/>
        <link rel="next" title="Metrics" href="metrics.html"/>
        <link rel="prev" title="Testing" href="testing.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Ichnaea
          

          
          </a>

          
            
            
              <div class="version">
                1.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Using the Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">Services API</a></li>
<li class="toctree-l1"><a class="reference internal" href="import_export.html">Data Import / Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy.html">Installing / Deploying</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Application Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Calculation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#accuracy">Accuracy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wifi">WiFi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gsm">GSM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wcdma-umts">WCDMA / UMTS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lte">LTE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#geoip">GeoIP</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="internal_api/index.html">Internal Code API</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Ichnaea</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Calculation</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/calculation.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="calculation">
<span id="id1"></span><h1>Calculation<a class="headerlink" href="#calculation" title="Permalink to this headline">¶</a></h1>
<p>There&#8217;s two general approaches to calculate positions from signal sources,
without the cooperation of the signal sources or mobile networks.</p>
<ol class="arabic simple">
<li>Determine the location of signal sources from <a class="reference internal" href="glossary.html#term-observations"><span class="xref std std-term">observations</span></a>,
then compare / trilaterate user locations.</li>
<li>Generate signal fingerprints for a fine-grained grid of the world.
Find best match for a observed fingerprint.</li>
</ol>
<p>The second approach has a much better accuracy, but relies on a lot more
available and constantly updated data. For most of the world this
approach is not practical, so we currently focus on approach one.</p>
<p>In theory one would assume that one could use signal strength data to
infer a distance measure from it. The further a device is away from the
signal source, the weaker the signal should get.</p>
<p>Unfortunately the signal strength is more dependent on the device type,
how a user holds a device and changing environmental factors like trucks in
the way. Even worse modern networks adjust their signal strength to the number
of devices inside their reception area. This makes this data practically
useless while looking up a users position via a single reading.</p>
<p>In aggregate over many data points this information can still be valuable
in determining the actual position of the signal source. While observing
multiple signals at once, their relative strengths can also be used, as
this keeps some of the changing factors constant, like the device type.</p>
<p>One other approach is using time of flight data as a distance metric.
While there are some reflection and multipath problems it&#8217;s a much more
accurate distance predictor. Fine grained enough timing data is
unfortunately almost never available to the application or operating
system layer in client devices. Some LTE networks and really modern
WiFi networks with support for 802.11v are the rare exception to this.
But these are so rare, that we currently ignore timing data.</p>
<div class="section" id="accuracy">
<h2>Accuracy<a class="headerlink" href="#accuracy" title="Permalink to this headline">¶</a></h2>
<p>Depending on the signal standard, we can promise different sorts of accuracy.</p>
<p>Underlying this is the assumption that we have enough data about the
area at all. With no or too little data we&#8217;ll have to fallback to less
accurate data sources. WiFi is the most accurate, followed by cell based
estimation using single cells, multiple cells or cell location areas.
If all else fails GeoIP serves as a general fallback.</p>
<div class="section" id="wifi">
<h3>WiFi<a class="headerlink" href="#wifi" title="Permalink to this headline">¶</a></h3>
<p>WiFi networks have a fairly limited range, with buildings in the way often
only in the tens or low hundreds of meters. But caching layers in the
operating system and time differences between when a WiFi scan happened
and when this is made available to the calling app can lead to WiFi networks
still being visible up to some kilometers away from their actual position
if the device moves in the meantime.</p>
<p>This means position estimates based on WiFi networks are usually accurate
to low hundreds of meters. If a lot of networks are available in the area
accuracy tends to increase to 100 meter or less.</p>
<p>One challenge that&#8217;s particular severe in WiFi networks are all the
constantly moving WiFi networks, for example those installed on buses
or trains or in the form of hotspot enabled mobile phones or tablets.
So movement detection and detecting inconsistencies between observed
data and the database world view are important considerations.</p>
</div>
<div class="section" id="gsm">
<h3>GSM<a class="headerlink" href="#gsm" title="Permalink to this headline">¶</a></h3>
<p>For GSM networks we will likely have access to the unique cell id of the
serving cell only. In GSM networks the phone does not know the full cell
ids of any neighboring cells, unless it associates with the new cell as
part of a hand-over, forgetting the cell id of the old cell.</p>
<p>So we are limited to a basic <a class="reference internal" href="glossary.html#term-cell-id"><span class="xref std std-term">Cell-ID</span></a> approach, meaning we assume
that the user is at the center of the current GSM cell area and use the
cell radius as the accuracy.</p>
<p>GSM cells are restricted to a maximum range of 35km, but there are rare
exceptions using the GSM extended range of 120km.</p>
<p>In more populated places the cell sizes are typically much smaller, but
generally accuracy will be in the tens of kilometer range.</p>
</div>
<div class="section" id="wcdma-umts">
<h3>WCDMA / UMTS<a class="headerlink" href="#wcdma-umts" title="Permalink to this headline">¶</a></h3>
<p>In WCDMA networks neighboring cell information can be available. But
limitations in chipset drivers, the radio interface layer and the
operating systems often hide this data from application code. Or
only partially expose the cell identifiers, for example only exposing
the carrier and primary scrambling code of the neighboring cells.</p>
<p>So in most cases we are limited to the same approach as for GSM cells.
The typical cell sizes of UMTS cells are much smaller, which practically
leads to a better accuracy. But WCDMA cells in rural areas can have a
larger radius than GSM cells and we observed cells sizes of 60-70km.</p>
<p>In urban areas we should typically see accuracy in the 1 to 10 kilometer
range.</p>
</div>
<div class="section" id="lte">
<h3>LTE<a class="headerlink" href="#lte" title="Permalink to this headline">¶</a></h3>
<p>LTE networks are similar to WCDMA networks and the same restriction on
neighboring cells applies. Instead of a primary scrambling code LTE uses
a physical cell id, which for our purposes has similar characteristics.</p>
<p>LTE cells are again often even smaller than WCDMA cells which leads to
better accuracies.</p>
<p>LTE networks also expose a time based distance metric in the form of
the timing advance. While we currently don&#8217;t use this information, in
the future it has the potential to significantly improve position
estimates based on multiple cells.</p>
</div>
<div class="section" id="geoip">
<h3>GeoIP<a class="headerlink" href="#geoip" title="Permalink to this headline">¶</a></h3>
<p>The accuracy of GeoIP depends a lot on the country or region the user
is in. In the US GeoIP can be fairly accurate and often places the
user in the right city or metropolitan area. In many other parts of
the world GeoIP is only accurate to the region level.</p>
<p>Typical GeoIP accuracies are either in the 50km range for city based
estimates or multiple hundred kilometers for region based estimates.</p>
<p>IP version 6 has the chance to improve this situation, as the need for
private carrier networks and network address translation decreases.
But so far this hasn&#8217;t made any measurable impact and most traffic
is still restricted to IP version 4.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="metrics.html" class="btn btn-neutral float-right" title="Metrics" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="testing.html" class="btn btn-neutral" title="Testing" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2015, Mozilla.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>